define("assignsubmission_declaration/assignsubmission_declaration",["exports","assignsubmission_declaration/modal_add_new_declaration","core/modal_factory"],(function(_exports,_modal_add_new_declaration,_modal_factory){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modal_add_new_declaration=_interopRequireDefault(_modal_add_new_declaration),_modal_factory=_interopRequireDefault(_modal_factory);var addDeclarationHandler=function(e){console.log(e);var trigger=$("#add-new-declaration-btn");_modal_factory.default.create({type:_modal_add_new_declaration.default.TYPE},trigger)},selectSubmissionHandler=function(e){e.target.checked?showSubmissionDeclarationElements():hideSubmissionDeclarationElements()},hideSubmissionDeclarationElements=function(){var match=Array.from(document.querySelectorAll("[id^=id_assignsubmission_declaration_]"));document.getElementById("add-new-declaration-btn").style.display="none",match.forEach((function(el){"id_assignsubmission_declaration_enabled"!=el.getAttribute("id")&&(el.style.display="none")}))},showSubmissionDeclarationElements=function(){document.getElementById("add-new-declaration-btn").style.display="inline-block",Array.from(document.querySelectorAll("[id^=id_assignsubmission_declaration_]")).forEach((function(el){"id_assignsubmission_declaration_enabled"!=el.getAttribute("id")&&(el.style.display="")}))},changeTextareaHandler=function(e){console.log("changeTextareaHandler"),""==document.getElementById(e.target.id).value?(document.getElementById(e.target.id).classList.add("empty-value-error"),document.getElementById(e.target.id).value="Declaration description cannot be empty"):document.getElementById(e.target.id).classList.remove("empty-value-error");var id=e.target.id.split("_");id=id[id.length-1];var data=JSON.parse(document.getElementById("id_declarationjson").value),updateData={id:id,declaration_text:document.getElementById(e.target.id).value};console.log(updateData),data.forEach((function(d){console.log(d),d.id==updateData.id&&"Declaration description cannot be empty"!=updateData.declaration_text&&(d.declaration_text=updateData.declaration_text)}),updateData),document.getElementById("id_declarationjson").value=JSON.stringify(data)},changeTitleHandler=function(e){console.log(e.target.id),""==document.getElementById(e.target.id).innerHTML?(document.getElementById(e.target.id).innerHTML="Title cannot be empty",document.getElementById(e.target.id).style.border="2px solid red"):document.getElementById(e.target.id).style.border="";var id=e.target.id.split("_");id=id[id.length-1],console.log(e.target.id);var data=JSON.parse(document.getElementById("id_declarationjson").value),updateData={id:id,declaration_title:document.getElementById(e.target.id).innerHTML.replace(/^\s+|\s+$/g,"")};console.log(updateData),data.forEach((function(d){console.log(d),d.id==updateData.id&&"Title cannot be empty"!=updateData.declaration_title&&(d.declaration_title=updateData.declaration_title)}),updateData),document.getElementById("id_declarationjson").value=JSON.stringify(data)},selectHandler=function(e){console.log("selectHandler");var id=e.target.id.split("_");id=id[id.length-2];var data=JSON.parse(document.getElementById("id_declarationjson").value),updateData={id:id,selected:e.target.checked?1:0};data.forEach((function(d){d.id==updateData.id&&(d.selected=updateData.selected)}),updateData),document.getElementById("id_declarationjson").value=JSON.stringify(data)},deleteDeclarationHandler=function(e){var id=e.target.id.split("_");id=id[id.length-1];var data=JSON.parse(document.getElementById("id_declarationjson").value),updateData={id:id,deleted:1};data.forEach((function(d){d.id==updateData.id&&(d.deleted=updateData.deleted)}),updateData),document.getElementById("id_declarationjson").value=JSON.stringify(data)};_exports.init=function(){document.getElementById("id_assignsubmission_declaration_enabled").checked?document.getElementById("add-new-declaration-btn").style.display="inline-block":document.getElementById("add-new-declaration-btn").style.display="none",document.getElementById("id_assignsubmission_declaration_enabled").addEventListener("change",selectSubmissionHandler),document.querySelector(".add-new-declaration").addEventListener("click",addDeclarationHandler),document.querySelectorAll("textarea[id^=id_assignsubmission_declaration_]").forEach((function(textarea){textarea.addEventListener("change",changeTextareaHandler)})),document.querySelectorAll("input[id^=id_assignsubmission_declaration_]").forEach((function(checkbox){var id=checkbox.getAttribute("id").split("_");"check"==id[id.length-1]&&checkbox.addEventListener("change",selectHandler)})),delete_declaration_1,document.querySelectorAll("i[id^=delete_declaration_]").forEach((function(deleteicon){deleteicon.addEventListener("click",deleteDeclarationHandler)})),Array.from(document.querySelectorAll("#fgroup_id_assignsubmission_declaration_group")).forEach((function(child,index){Array.from(child.children).forEach((function(child1,index){Array.from(child1.children).forEach((function(child,index){0==index&&"P"==child.nodeName&&(child.setAttribute("contenteditable",!0),child.addEventListener("input",changeTitleHandler))}),child1)}))}))}}));

//# sourceMappingURL=assignsubmission_declaration.min.js.map