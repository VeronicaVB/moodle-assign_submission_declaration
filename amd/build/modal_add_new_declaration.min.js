define("assignsubmission_declaration/modal_add_new_declaration",["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","core/modal_events"],(function($,Notification,CustomEvents,Modal,ModalRegistry,ModalEvents){var registered=!1,SELECTORS_ADD_BUTTON='[data-action="add"]',SELECTORS_CANCEL_BUTTON='[data-action="cancel"]',ModalAddDeclaration=function(root){Modal.call(this,root),this.getFooter().find(SELECTORS_ADD_BUTTON).length||Notification.exception({message:"No add button found"}),this.getFooter().find(SELECTORS_CANCEL_BUTTON).length||Notification.exception({message:"No cancel button found"})};return ModalAddDeclaration.TYPE="assignsubmission_declaration-adddeclaration",(ModalAddDeclaration.prototype=Object.create(Modal.prototype)).constructor=ModalAddDeclaration,ModalAddDeclaration.prototype.registerEventListeners=function(){Modal.prototype.registerEventListeners.call(this),this.getModal().on(CustomEvents.events.activate,SELECTORS_ADD_BUTTON,function(e,data){var _this=this,currentIds=Array.from(document.querySelectorAll("[id^=id_assignsubmission_declaration_]")).filter((function(id){if(id.getAttribute("id").match(/(\d+)\D*$/))return id})),lastNumber=currentIds[currentIds.length-2].getAttribute("id");lastNumber=(lastNumber=lastNumber.split("_")).filter((function(val){if(!isNaN(val))return val}));var newID=parseInt(lastNumber[lastNumber.length-1])+1,newDec={declaration_title:document.getElementById("inputTitle").value,declaration_text:document.getElementById("inputContent").value,id:newID,assignment:document.getElementById("id_declarationjson").getAttribute("assignmentid"),selected:0};if(document.getElementById("inputTitle").classList.remove("input-error"),document.getElementById("inputContent").classList.remove("input-error"),""!=newDec.declaration_title)if(""!=newDec.declaration_text){var declaration=document.getElementById("fgroup_id_assignsubmission_declaration_group"),declarationSubmissionContainer=document.getElementById("id_submissiontypescontainer"),btnContainer=document.querySelector(".add-new-declaration-container"),newDeclaration=declaration.cloneNode(!0);newDeclaration.removeAttribute("id"),Array.from(newDeclaration.children).forEach((function(child,index){var oldID=child.children[index].getAttribute("id");0==index?(child.children[index].setAttribute("id","".concat(oldID,"_").concat(newDec.declaration_title," ")),child.children[index].innerHTML=newDec.declaration_title):Array.from(child.children).forEach((function(child,index){0==index&&Array.from(child.children).forEach((function(child,index){0==index?child.innerHTML=newDec.declaration_title:Array.from(child.children).forEach((function(child,index){0==index?child.setAttribute("for","id_assignsubmission_declaration_".concat(newDec.id)):1==index?(child.innerHTML=newDec.declaration_text,child.removeAttribute("placeholder"),child.setAttribute("value",newDec.declaration_text),child.setAttribute("id","id_assignsubmission_declaration_".concat(newDec.id)),child.setAttribute("name","assignsubmission_declaration_".concat(newDec.id))):2==index?Array.from(child.children).forEach((function(child,index){console.log("CHECKBOX"),console.log(child),child.value=0,child.removeAttribute("checked"),child.setAttribute("id","id_assignsubmission_declaration_".concat(newDec.id,"_check")),child.setAttribute("name","assignsubmission_declaration_".concat(newDec.id,"_check")),child.addEventListener("change",(function(e){if(e.target.checked){var _declaration=JSON.parse(document.getElementById("id_declarationjson").value);_declaration.forEach((function(decl){decl.id==newDec.id&&(decl.selected=1)}),newDeclaration),document.getElementById("id_declarationjson").value=JSON.stringify(_declaration)}}))})):child.setAttribute("id","id_assignsubmission_declaration_".concat(newDec.id,"_check"))}))}))})),_this.destroy()}),newDec);var decl=JSON.parse(document.getElementById("id_declarationjson").value);decl.push(newDec),document.getElementById("id_declarationjson").value=JSON.stringify(decl),declarationSubmissionContainer.insertBefore(newDeclaration,btnContainer)}else document.getElementById("inputContent").classList.add("input-error");else document.getElementById("inputTitle").classList.add("input-error")}.bind(this)),this.getModal().on(CustomEvents.events.activate,SELECTORS_CANCEL_BUTTON,function(e,data){this.destroy()}.bind(this))},registered||(ModalRegistry.register(ModalAddDeclaration.TYPE,ModalAddDeclaration,"assignsubmission_declaration/assignsubmission_declaration_modal"),registered=!0),ModalAddDeclaration}));

//# sourceMappingURL=modal_add_new_declaration.min.js.map